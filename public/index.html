<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Welcome to Firebase Hosting?</title>
    <link rel="stylesheet" href="css/standard.css">
    <link href='https://fonts.googleapis.com/css?family=Asul' rel='stylesheet'> <!--google font-->

<script src="https://www.gstatic.com/firebasejs/8.2.9/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.2.9/firebase-firestore.js"></script>
<script src ="public\scripts\user.js"></script>

<script>
// Your web app's Firebase configuration
  var firebaseConfig = {
    apiKey: "AIzaSyBZHOCoQiHyeTIsYQsR_rD0QzHQv0RaAbA",
    authDomain: "wichacks2021.firebaseapp.com",
    databaseURL: "https://wichacks2021-default-rtdb.firebaseio.com",
    projectId: "wichacks2021",
    storageBucket: "wichacks2021.appspot.com",
    messagingSenderId: "205291654588",
    appId: "1:205291654588:web:5f58beb8bc0afb3a3c6fb9"
  };
  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);

  var db = firebase.firestore();
</script>

 </head>
  <body>

	<center>
		<h1>Energy Monitor</h1>
		<h4>Login</h4>
		<div id = "login_form_div">
		<form id = "login_form">
			<input type = "text" name = "username" id = "username"><br>
			<input type = "text" name = "password" id = "password"><br>
      <input type="button" onclick="submit()">
		</form>
		</div>
		<div id = "sign_up_notice">
			<p>Don't have an account? <a href = "/sign-up.html">Sign up here.</a>
		</div>
		<p id = "message"></p>
	</center>

<script>      
    
    class User {
        constructor(password) {
          this.password = password;
        }
        toString() {
          return "userpass: " + this.password;
        }

      }

      // Firestore data converter
      var userConverter = {
        toFirestore: function (user) {
          return {
            username: user.username,
          };
        },
        fromFirestore: function (snapshot, options) {
          const data = snapshot.data(options);
          return new User(data.password,);
        }
      };

    function submit(){
      
      var username = document.getElementById("username").value;
      var password = document.getElementById("password").value;
      
      db.collection("users").doc(username).withConverter(userConverter).get().then((doc) => {
        if (doc.exists) {
          // Convert to City object
          var user = doc.data();
          // Use a user instance method
          console.log(user.toString());
        
        } else {
          console.log("No such document!");
        }
      }).catch((error) => {
        console.log("Error getting document:", error);
      });;
      
      
	}
  
  //if (users.password == password) {
  //  document.getElementById("message").innerHTML = "Success!";
  //}
  //else {

  //  document.getElementById("message").innerHTML = "Sumthin went wrong  : (";
  //}
	//document.getElementById("message").innerHTML = "test";
  //    document.getElementById("login_form").onsubmit = submit();

      </script>
  </body>
</html>
